\documentclass[10pt, conference, compsoc, twocolumn]{IEEEtran}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{cite}

\begin{document}

\title{ECG Heartbeat Classification using a Hybrid CNN--LSTM Deep Learning Framework}

\author{
    \IEEEauthorblockN{Doan Duy Thanh}
    \IEEEauthorblockA{Student ID: 22BA13286 \\
    Lecture: Tran Giang Son \\
    University of Science and Technology of Hanoi (USTH) \\
    Email: thanh.dd22ba13286@usth.edu.vn}
}

\maketitle

\begin{abstract}
Electrocardiogram (ECG) analysis is a fundamental task in clinical cardiology for detecting cardiovascular diseases. In this practical study, we used two CNN models in combination with LSTM to classify normal and abnormal ECGs. The final results showed a 97\% accuracy rate, significantly improving the classification of normal and abnormal groups in the problem.
\end{abstract}

\begin{IEEEkeywords}
ECG Classification, CNN-LSTM, Deep Learning, PTB Diagnostic Database, Signal Processing.
\end{IEEEkeywords}

\section{Introduction}
Cardiovascular disease is one of the most dangerous diseases, posing a threat in many places. Electrocardiograms (ECGs) are a non-invasive medical tool that records the electrical activity of the heart, providing crucial information about cardiovascular health. However, manually interpreting long-term ECG recordings is labor-intensive and prone to human error; therefore, the development of automated, highly accurate diagnostic methods is necessary.

As we know, many traditional machine learning methods exist to address this issue. Here, I would like to propose a solution using Deep Learning.


\begin{itemize}
    \item \textbf{Convolutional Neural Networks} help learn the basic features of the data, in this case, the ECG signal.
    \item \textbf{Long Short-Term Memory networks (LSTMs)} are capable of learning long-term time dependencies, which is important due to the sequential nature of the cardiac cycle.
\end{itemize}


Now we will proceed to explore the provided data. I want to visualize the data using 1D images and employ the PCA algorithm to create a visual representation that allows the reader to understand the data in 3D space.

\section{Dataset and Exploratory Data Analysis}
\subsection{Dataset Description}
The study utilizes the \textbf{PTB Diagnostic ECG Database} sourced from Kaggle. This dataset is a collection of ECG signals recorded from healthy volunteers and patients with various heart conditions. The data is provided in a pre-processed format where each heartbeat is segmented into a fixed length of 188 time steps. The labels are defined as:
\begin{itemize}
    \item \textbf{Class 0 (Normal):} Signals with regular sinus rhythms.
    \item \textbf{Class 1 (Abnormal):} Signals exhibiting pathologies such as Myocardial Infarction.
\end{itemize}

\subsection{Class Distribution and Imbalance}
Initial data exploration reveals a significant class imbalance. As shown in Fig. 1, the "Abnormal" class constitutes approximately 72.2\% of the dataset (10,506 samples), while "Normal" heartbeats make up the remaining 27.8\% (4,046 samples).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.85\linewidth]{16.1.png}
    \caption{Distribution of Normal and Abnormal classes in the PTB Diagnostic ECG dataset.}
    \label{fig:dist}
\end{figure}

\subsection{ECG Morphology Visualization}
Each pattern represents a cardiac cycle. Figure 2 illustrates the standard components of an ECG waveform: such as the P wave (atrial depolarization), the QRS complex (ventricular depolarization), and the T wave (ventricular repolarization). These are all important points for the reader to grasp and understand in detail.

\begin{figure}[h]
    \centering
    \includegraphics[width=1.0\linewidth]{16.2.png}
    \caption{Morphological visualization of an individual ECG heartbeat signal.}
    \label{fig:morph}
\end{figure}

\section{Methodology}
\subsection{Mathematical Formulation}
The 1D Convolutional layer extracts features using a kernel sliding over the time-series signal:
\begin{equation}
y_t = f\left( \sum_{i=0}^{n-1} w_i \cdot x_{t+i} + b \right)
\end{equation}
To capture temporal dependencies, the LSTM unit utilizes a series of gates (Forget, Input, and Output) to update the cell state ($C_t$) and hidden state ($h_t$), allowing the model to remember significant peaks and intervals over the 188-step duration.

\subsection{CNN--LSTM Architecture}
As described in, our model combines the strengths of both architectures:
\begin{enumerate}
    \item \textbf{CNN Block:} Two Conv1D layers (32 and 64 filters) with kernel sizes 7 and 5 to capture spatial morphology.
    \item \textbf{LSTM Block:} An LSTM layer with 32 units to model the temporal sequence of the heartbeat.
    \item \textbf{Classification:} Dense layers with Dropout (0.5) to prevent overfitting, leading to a Sigmoid output for binary classification.
\end{enumerate}

\section{Experimental Results}
\subsection{Training Performance}
The model I chose uses Adam's algorithm for the optimization step, like many other problems. The learning rate I selected is around 0.00005, and my model is slightly overfitting due to the data being too well normalized.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.9\linewidth]{16.4.png}
    \caption{CNN + LSTM Training Performance curves.}
    \label{fig:training}
\end{figure}

\subsection{Classification Results}
The model achieved an accuracy of 97\%. The Confusion Matrix in Fig. 4 highlights the model's sensitivity: out of 2,102 abnormal samples, the model correctly identified 2,090, yielding a recall of 99\% for the pathological class.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.85\linewidth]{16.5.png}
    \caption{Confusion Matrix on the test set.}
    \label{fig:cm}
\end{figure}

\section{In-depth Analysis}
\subsection{Performance Metrics Analysis}
To provide an overall assessment, I relied on accuracy, recall, and F1 scores for both classes. As shown in Table 1, the model maintained high F1 scores across both categories.

\begin{table}[h]
\centering
\caption{Detailed Classification Metrics}
\begin{tabular}{lcccc}
\toprule
\textbf{Class} & \textbf{Precision} & \textbf{Recall} & \textbf{F1-Score} & \textbf{Support} \\ \midrule
Normal (0)     & 0.98               & 0.91            & 0.94              & 809              \\
Abnormal (1)   & 0.97               & 0.99            & 0.98              & 2102             \\ \midrule
\textbf{Total/Avg} & \textbf{0.97}      & \textbf{0.97}   & \textbf{0.97}     & \textbf{2911}    \\ \bottomrule
\end{tabular}
\end{table}

The high recall (0.99) for the Abnormal class is crucial for medical applications, as it minimizes "False Negatives"â€”cases where a diseased heart is incorrectly labeled as healthy.

\subsection{PCA Space Visualization}
We applied 3D Principal Component Analysis (PCA) to project the high-dimensional ECG signals (188 features) into a visible subspace. 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.9\linewidth]{16.3.png}
    \caption{3D PCA visualization of ECG signals showing distinct clusters.}
    \label{fig:pca}
\end{figure}

In Figure 5, normal and abnormal signals occupy different regions in the feature space. Overall, they appear to overlap. This confirms that the CNN-LSTM layers effectively minimized gross noise and extracted the intrinsic biological features necessary for accurate classification.

\section{Discussion: Comparison with Original Paper}
Our results show strong alignment with the findings in the original paper (1805.00794).
\begin{itemize}
    \item \textbf{Accuracy:} The paper reported an accuracy of approximately 97.4\% for the PTB dataset. Our model achieved a comparable 97\%, confirming the reproducibility of the CNN-based approach.
    \item \textbf{Model Robustness:} Similar to, our model demonstrates high recall for the Abnormal class. The original study emphasized that deep learning architectures are superior in detecting myocardial infarction compared to traditional feature-based methods.
    \item \textbf{Architecture Synergy:} Our integration of LSTM extends the spatial-only focus of the original paper, providing a more comprehensive temporal analysis of the cardiac rhythm.
\end{itemize}

\section{Conclusion}
This study implemented a CNN-LSTM model for ECG classification, achieving 97\% accuracy. The results validate that combining spatial and temporal features is highly effective for medical signal diagnosis.

\begin{thebibliography}{1}
\bibitem{ptb_kaggle}
M. Kachuee, S. Fazeli, and M. Sarrafzadeh, "ECG Heartbeat Categorization Dataset," Kaggle, 2018. [Online]. Available: \url{https://www.kaggle.com/shayanfazeli/heartbeat}
\bibitem{paper_ref}
M. Kachuee, S. Fazeli, and M. Sarrafzadeh, "ECG Heartbeat Classification Using Deep Convolutional Neural Networks," \textit{2018 IEEE BHI}, pp. 447-450, 2018.
\end{thebibliography}

\end{document}  